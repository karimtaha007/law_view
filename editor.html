<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Floor Plan Editor - Professional Edition</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      height: 100vh; 
      display: flex; 
      flex-direction: column; 
      overflow: hidden; 
    }
    
    .toolbar {
      background: linear-gradient(135deg, #16213e 0%, #0f3460 100%);
      padding: 12px 15px;
      display: flex;
      gap: 12px;
      border-bottom: 2px solid #e94560;
      flex-wrap: wrap;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    
    .toolbar-group {
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 0 12px;
      border-right: 1px solid rgba(255,255,255,0.1);
    }
    .toolbar-group:last-child { border-right: none; }
    
    .toolbar-label { 
      color: #8892b0; 
      font-size: 11px; 
      text-transform: uppercase; 
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    
    .btn {
      padding: 9px 14px;
      border: none;
      border-radius: 6px;
      background: #0f3460;
      color: white;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .btn:hover { 
      background: #e94560; 
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(233, 69, 96, 0.3);
    }
    .btn.active { background: #e94560; }
    .btn.save { 
      background: linear-gradient(135deg, #00ff88 0%, #00cc6f 100%);
      color: #1a1a2e; 
      font-weight: bold;
      padding: 9px 18px;
    }
    .btn.save:hover {
      background: linear-gradient(135deg, #00cc6f 0%, #00ff88 100%);
    }
    .btn.viewport-btn { background: #4a90d9; }
    .btn.viewport-btn:hover { background: #5ba0e9; }
    .btn.viewport-btn.saved { 
      background: linear-gradient(135deg, #00ff88 0%, #00cc6f 100%);
      color: #1a1a2e; 
    }
    
    input[type=number] { 
      padding: 9px;
      width: 70px;
      background: #0d0d1a;
      border: 1px solid #333;
      color: white;
      border-radius: 5px;
      font-family: monospace;
      font-size: 13px;
    }
    input[type=number]:focus {
      outline: none;
      border-color: #e94560;
    }
    
    input[type=range] {
      width: 150px;
      height: 6px;
      background: #0d0d1a;
      border-radius: 3px;
      outline: none;
      -webkit-appearance: none;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      background: #e94560;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    input[type=range]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      background: #e94560;
      border-radius: 50%;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    #viewport { 
      flex: 1; 
      position: relative; 
      background: #0d0d1a; 
      overflow: hidden; 
      cursor: crosshair;
      box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
    }
    #map-container { position: absolute; transform-origin: 0 0; }
    
    .point {
      position: absolute;
      background: rgba(233, 69, 96, 0.7);
      border: 2px solid #e94560;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.15s, background 0.15s;
      font-weight: bold;
      box-shadow: 0 2px 6px rgba(233, 69, 96, 0.4);
    }
    .point:hover { 
      transform: translate(-50%, -50%) scale(1.3); 
      z-index: 100; 
      background: #e94560;
      box-shadow: 0 4px 12px rgba(233, 69, 96, 0.6);
    }
    
    .sidebar { 
      width: 300px; 
      background: linear-gradient(180deg, #16213e 0%, #0f3460 100%);
      border-left: 2px solid #e94560;
      display: flex; 
      flex-direction: column;
      box-shadow: -4px 0 12px rgba(0,0,0,0.3);
    }
    
    .sidebar-section {
      padding: 18px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .sidebar-section h4 { 
      color: #e94560; 
      margin-bottom: 12px; 
      font-size: 13px; 
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 700;
    }
    
    .viewport-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .info-item {
      background: #0d0d1a;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .info-item .label { 
      color: #8892b0; 
      font-size: 10px; 
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    .info-item .value { 
      color: #00ff88; 
      font-size: 15px; 
      font-weight: bold; 
      font-family: monospace;
    }
    
    .point-list { flex: 1; overflow-y: auto; padding: 12px; }
    .log-item { 
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      color: #ccc;
      font-size: 13px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 5px;
      margin-bottom: 5px;
      background: #0d0d1a;
      transition: all 0.2s;
    }
    .log-item:hover { 
      background: #0f3460;
      transform: translateX(3px);
    }
    .del-btn { 
      color: #ff4d4d; 
      cursor: pointer; 
      font-weight: bold; 
      padding: 3px 10px;
      border-radius: 4px;
      transition: all 0.2s;
    }
    .del-btn:hover {
      background: #ff4d4d;
      color: white;
    }
    
    .status-bar {
      background: #0d0d1a;
      padding: 10px 18px;
      border-top: 2px solid #0f3460;
      display: flex;
      justify-content: space-between;
      color: #8892b0;
      font-size: 11px;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.2);
    }
    .status-indicator { display: flex; align-items: center; gap: 8px; }
    .status-dot { 
      width: 10px; 
      height: 10px; 
      border-radius: 50%;
      box-shadow: 0 0 6px currentColor;
    }
    .status-dot.saved { background: #00ff88; color: #00ff88; }
    .status-dot.unsaved { background: #ffa500; color: #ffa500; }

    /* Preview Frame Overlay */
    .preview-frame {
      position: absolute;
      border: 3px dashed #4a90d9;
      pointer-events: none;
      z-index: 1000;
      display: none;
      background: rgba(74, 144, 217, 0.05);
    }
    .preview-frame.active { display: block; }
    .preview-label {
      position: absolute;
      top: -28px;
      left: 0;
      background: #4a90d9;
      color: white;
      padding: 4px 10px;
      font-size: 11px;
      border-radius: 4px;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    /* Point Size Preview */
    .size-preview {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: #0d0d1a;
      border-radius: 6px;
      border: 1px solid #333;
      position: relative;
    }
    .size-preview-dot {
      background: #e94560;
      border-radius: 50%;
      border: 2px solid #ff6b88;
      transition: all 0.2s;
    }
  </style>
</head>
<body>

<div class="toolbar">
  <div class="toolbar-group">
    <h3 style="color:#00ff88; letter-spacing:1px;">üìê FLOOR PLAN EDITOR</h3>
  </div>
  
  <div class="toolbar-group">
    <button class="btn active" id="modeDraw">‚úèÔ∏è Draw</button>
    <button class="btn" id="modePan">‚úã Pan</button>
  </div>
  
  <div class="toolbar-group">
    <span class="toolbar-label">Next ID:</span>
    <input type="number" id="nextId" value="1" min="1">
  </div>
  
  <div class="toolbar-group">
    <span class="toolbar-label">Point Size:</span>
    <input type="range" id="pointSizeSlider" min="1" max="200" value="24" step="1">
    <input type="number" id="pointSizeInput" value="24" min="1" max="200" step="1">
    <div class="size-preview">
      <div class="size-preview-dot" id="sizePreviewDot"></div>
    </div>
  </div>
  
  <div class="toolbar-group">
    <button class="btn" onclick="zoom(1.2)">‚ûï</button>
    <button class="btn" onclick="zoom(0.8)">‚ûñ</button>
    <button class="btn" onclick="fitToScreen()">‚õ∂ Fit</button>
  </div>
  
  <div class="toolbar-group">
    <button class="btn viewport-btn" id="btnSetViewport">üìê Set Initial View</button>
    <button class="btn viewport-btn" id="btnPreviewViewport">üëÅÔ∏è Preview</button>
  </div>
  
  <div class="toolbar-group" style="margin-left:auto; border-right:none;">
    <button class="btn save" id="btnSave">üíæ EXPORT DATA</button>
  </div>
</div>

<div style="flex:1; display:flex;">
  <div id="viewport">
    <div id="map-container">
      <img id="floorImage" src="floor1.jpg" style="pointer-events:none; user-select:none;">
    </div>
    <div class="preview-frame" id="previewFrame">
      <span class="preview-label">Initial View Frame</span>
    </div>
  </div>
  
  <div class="sidebar">
    <div class="sidebar-section">
      <h4>üìç Current Viewport</h4>
      <div class="viewport-info">
        <div class="info-item">
          <div class="label">Zoom</div>
          <div class="value" id="infoZoom">100%</div>
        </div>
        <div class="info-item">
          <div class="label">Points</div>
          <div class="value" id="infoPoints">0</div>
        </div>
        <div class="info-item">
          <div class="label">Pan X</div>
          <div class="value" id="infoPanX">0</div>
        </div>
        <div class="info-item">
          <div class="label">Pan Y</div>
          <div class="value" id="infoPanY">0</div>
        </div>
      </div>
    </div>
    
    <div class="sidebar-section" id="savedViewSection" style="display:none;">
      <h4>‚úÖ Saved Initial View</h4>
      <div class="viewport-info">
        <div class="info-item">
          <div class="label">Zoom</div>
          <div class="value" id="savedZoom">-</div>
        </div>
        <div class="info-item">
          <div class="label">Size</div>
          <div class="value" id="savedSize">-</div>
        </div>
        <div class="info-item" style="grid-column: 1/-1;">
          <button class="btn" onclick="clearSavedViewport()" style="width:100%; justify-content:center;">üóëÔ∏è Clear Saved View</button>
        </div>
      </div>
    </div>
    
    <div class="sidebar-section" style="flex-shrink:0;">
      <h4>üìã Points List</h4>
    </div>
    <div class="point-list" id="pointList"></div>
  </div>
</div>

<div class="status-bar">
  <div class="status-indicator">
    <span class="status-dot" id="statusDot"></span>
    <span id="statusText">Ready</span>
  </div>
  <div id="mouseCoords" style="font-family:monospace;">X: 0, Y: 0</div>
</div>

<script>
  // === STATE ===
  let scale = 1, x = 0, y = 0;
  let points = [];
  let isDragging = false;
  let mode = 'draw';
  let startX, startY;
  let currentPointSize = 24;
  let savedViewport = null;
  let hasUnsavedChanges = false;
  
  // === DOM ELEMENTS ===
  const viewport = document.getElementById('viewport');
  const container = document.getElementById('map-container');
  const nextIdInput = document.getElementById('nextId');
  const pointSizeSlider = document.getElementById('pointSizeSlider');
  const pointSizeInput = document.getElementById('pointSizeInput');
  const previewFrame = document.getElementById('previewFrame');
  const sizePreviewDot = document.getElementById('sizePreviewDot');
  
  // === INITIALIZATION ===
  document.getElementById('floorImage').onload = () => {
    fitToScreen();
    loadFromBrowser();
    updateInfoDisplay();
  };

  // If image is cached
  if (document.getElementById('floorImage').complete) {
    fitToScreen();
    loadFromBrowser();
    updateInfoDisplay();
  }

  // === MODE SWITCHING ===
  document.getElementById('modeDraw').onclick = () => {
    mode = 'draw';
    viewport.style.cursor = 'crosshair';
    document.getElementById('modeDraw').classList.add('active');
    document.getElementById('modePan').classList.remove('active');
  };

  document.getElementById('modePan').onclick = () => {
    mode = 'pan';
    viewport.style.cursor = 'grab';
    document.getElementById('modeDraw').classList.remove('active');
    document.getElementById('modePan').classList.add('active');
  };

  // === POINT SIZE CONTROL ===
  function updateSizePreview() {
    const size = Math.min(currentPointSize, 32); // Cap preview at 32px
    sizePreviewDot.style.width = size + 'px';
    sizePreviewDot.style.height = size + 'px';
  }

  pointSizeSlider.oninput = () => {
    currentPointSize = parseInt(pointSizeSlider.value);
    pointSizeInput.value = currentPointSize;
    updateSizePreview();
    saveToBrowser();
  };

  pointSizeInput.oninput = () => {
    let val = parseInt(pointSizeInput.value);
    if (val < 1) val = 1;
    if (val > 200) val = 200;
    currentPointSize = val;
    pointSizeSlider.value = val;
    pointSizeInput.value = val;
    updateSizePreview();
    saveToBrowser();
  };

  // Initialize preview
  updateSizePreview();

  // === ZOOM & TRANSFORM ===
  function updateTransform() {
    container.style.transform = `translate(${x}px, ${y}px) scale(${scale})`;
    updatePointScale();
    updateInfoDisplay();
    if (previewFrame.classList.contains('active')) {
      updatePreviewFrame();
    }
  }

  function updatePointScale() {
    const points = document.querySelectorAll('.point');
    points.forEach(el => {
      const baseSize = parseInt(el.dataset.size) || currentPointSize;
      const displaySize = baseSize / scale;
      el.style.width = displaySize + 'px';
      el.style.height = displaySize + 'px';
      el.style.fontSize = Math.max(8, 12 / scale) + 'px';
    });
  }

  function zoom(factor) {
    const rect = viewport.getBoundingClientRect();
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;

    const oldScale = scale;
    scale *= factor;
    scale = Math.max(0.1, Math.min(10, scale));

    x = centerX - (centerX - x) * (scale / oldScale);
    y = centerY - (centerY - y) * (scale / oldScale);

    updateTransform();
  }

  function fitToScreen() {
    const img = document.getElementById('floorImage');
    const vw = viewport.clientWidth;
    const vh = viewport.clientHeight;
    const iw = img.naturalWidth || 2000;
    const ih = img.naturalHeight || 2000;

    const scaleW = vw / iw;
    const scaleH = vh / ih;
    scale = Math.min(scaleW, scaleH) * 0.95;

    x = (vw - iw * scale) / 2;
    y = (vh - ih * scale) / 2;

    updateTransform();
  }

  function updateInfoDisplay() {
    document.getElementById('infoZoom').textContent = Math.round(scale * 100) + '%';
    document.getElementById('infoPoints').textContent = points.length;
    document.getElementById('infoPanX').textContent = Math.round(x);
    document.getElementById('infoPanY').textContent = Math.round(y);
  }

  // === INTERACTION ===
  viewport.addEventListener('mousedown', e => {
    if (mode === 'pan') {
      isDragging = true;
      startX = e.clientX - x;
      startY = e.clientY - y;
      viewport.style.cursor = 'grabbing';
    }
  });

  viewport.addEventListener('mousemove', e => {
    const rect = viewport.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;
    
    const mapX = Math.round((mouseX - x) / scale);
    const mapY = Math.round((mouseY - y) / scale);
    
    document.getElementById('mouseCoords').textContent = `X: ${mapX}, Y: ${mapY}`;

    if (isDragging && mode === 'pan') {
      x = e.clientX - startX;
      y = e.clientY - startY;
      updateTransform();
    }
  });

  viewport.addEventListener('mouseup', () => {
    isDragging = false;
    if (mode === 'pan') {
      viewport.style.cursor = 'grab';
    }
  });

  viewport.addEventListener('wheel', e => {
    e.preventDefault();
    const rect = viewport.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    const factor = e.deltaY > 0 ? 0.9 : 1.1;
    const oldScale = scale;
    scale *= factor;
    scale = Math.max(0.1, Math.min(10, scale));

    x = mouseX - (mouseX - x) * (scale / oldScale);
    y = mouseY - (mouseY - y) * (scale / oldScale);

    updateTransform();
  }, { passive: false });

  // === POINT PLACEMENT ===
  viewport.addEventListener('click', e => {
    if (mode !== 'draw') return;
    if (e.target !== viewport && !e.target.closest('#map-container')) return;

    const rect = viewport.getBoundingClientRect();
    const clickX = (e.clientX - rect.left - x) / scale;
    const clickY = (e.clientY - rect.top - y) / scale;

    const id = parseInt(nextIdInput.value);
    if (isNaN(id) || id < 1) {
      alert('Invalid ID number');
      return;
    }

    addPoint({ row: id, x: clickX, y: clickY, size: currentPointSize });
    nextIdInput.value = id + 1;
    saveToBrowser();
    markUnsaved();
  });

  // === POINT MANAGEMENT ===
  function addPoint(pData) {
    if (!points.find(p => p.row === pData.row)) {
      points.push(pData);
    }
    
    const el = document.createElement('div');
    el.className = 'point';
    el.textContent = pData.row;
    el.style.left = pData.x + 'px';
    el.style.top = pData.y + 'px';
    el.dataset.id = pData.row;
    el.dataset.size = pData.size || currentPointSize;
    
    // Apply size
    const displaySize = (pData.size || currentPointSize) / scale;
    el.style.width = displaySize + 'px';
    el.style.height = displaySize + 'px';
    
    el.addEventListener('contextmenu', e => {
      e.preventDefault();
      if(confirm('Delete point ' + pData.row + '?')) {
        deletePoint(pData.row);
      }
    });

    container.appendChild(el);
    renderSidebar();
    updateInfoDisplay();
  }

  function deletePoint(id) {
    points = points.filter(p => p.row !== id);
    const el = document.querySelector(`.point[data-id="${id}"]`);
    if (el) el.remove();
    renderSidebar();
    updateInfoDisplay();
    saveToBrowser();
    markUnsaved();
  }

  function renderSidebar() {
    const list = document.getElementById('pointList');
    list.innerHTML = points.sort((a,b) => a.row - b.row).map(p => `
      <div class="log-item">
        <span>#${p.row} <span style="color:#666; font-size:11px;">(${Math.round(p.x)}, ${Math.round(p.y)}) ‚Ä¢ ${p.size || currentPointSize}px</span></span>
        <span class="del-btn" onclick="deletePoint(${p.row})">√ó</span>
      </div>
    `).join('');
  }

  // === VIEWPORT STATE ===
  document.getElementById('btnSetViewport').onclick = () => {
    savedViewport = {
      scale: scale,
      x: x,
      y: y,
      pointSize: currentPointSize
    };
    
    document.getElementById('savedViewSection').style.display = 'block';
    document.getElementById('savedZoom').textContent = Math.round(scale * 100) + '%';
    document.getElementById('savedSize').textContent = currentPointSize + 'px';
    
    document.getElementById('btnSetViewport').classList.add('saved');
    document.getElementById('btnSetViewport').innerHTML = '‚úÖ View Saved';
    
    saveToBrowser();
    setStatus('Initial viewport saved!', 'saved');
    
    setTimeout(() => {
      document.getElementById('btnSetViewport').classList.remove('saved');
      document.getElementById('btnSetViewport').innerHTML = 'üìê Set Initial View';
    }, 2000);
  };

  function clearSavedViewport() {
    savedViewport = null;
    document.getElementById('savedViewSection').style.display = 'none';
    saveToBrowser();
    setStatus('Saved viewport cleared', 'unsaved');
  }

  // Preview frame
  let previewActive = false;
  document.getElementById('btnPreviewViewport').onclick = () => {
    previewActive = !previewActive;
    previewFrame.classList.toggle('active', previewActive);
    
    if (previewActive && savedViewport) {
      updatePreviewFrame();
    }
  };

  function updatePreviewFrame() {
    if (!savedViewport) {
      previewFrame.style.display = 'none';
      return;
    }
    
    const vw = viewport.clientWidth;
    const vh = viewport.clientHeight;
    
    const frameWidth = vw * (savedViewport.scale / scale);
    const frameHeight = vh * (savedViewport.scale / scale);
    
    previewFrame.style.width = frameWidth + 'px';
    previewFrame.style.height = frameHeight + 'px';
    previewFrame.style.left = savedViewport.x + 'px';
    previewFrame.style.top = savedViewport.y + 'px';
  }

  // === LOCAL STORAGE ===
  const STORAGE_KEY = 'floor_editor_v2';
  
  function saveToBrowser() {
    const data = {
      points: points,
      viewport: savedViewport,
      pointSize: currentPointSize,
      nextId: parseInt(nextIdInput.value)
    };
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  }
  
  function loadFromBrowser() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      const data = JSON.parse(saved);
      
      // Load points
      if (data.points) {
        data.points.forEach(p => addPoint(p));
        const maxId = data.points.reduce((max, p) => p.row > max ? p.row : max, 0);
        nextIdInput.value = data.nextId || (maxId + 1);
      }
      
      // Load viewport
      if (data.viewport) {
        savedViewport = data.viewport;
        document.getElementById('savedViewSection').style.display = 'block';
        document.getElementById('savedZoom').textContent = Math.round(data.viewport.scale * 100) + '%';
        document.getElementById('savedSize').textContent = (data.viewport.pointSize || 24) + 'px';
      }
      
      // Load point size
      if (data.pointSize) {
        currentPointSize = data.pointSize;
        pointSizeSlider.value = currentPointSize;
        pointSizeInput.value = currentPointSize;
        updateSizePreview();
      }
      
      setStatus('Loaded from browser storage', 'saved');
    }
  }

  // === STATUS ===
  function setStatus(text, type) {
    document.getElementById('statusText').textContent = text;
    document.getElementById('statusDot').className = 'status-dot ' + type;
  }
  
  function markUnsaved() {
    hasUnsavedChanges = true;
    setStatus('Unsaved changes', 'unsaved');
  }

  // === EXPORT ===
  document.getElementById('btnSave').onclick = async () => {
    // Try to load existing plate data
    let plateInfo = [];
    try {
      const res = await fetch('plate_data.json');
      plateInfo = await res.json();
    } catch (e) {
      console.log("No plate_data.json found");
    }

    // Build final data structure
    const finalData = {
      // Viewport configuration
      viewportConfig: savedViewport || {
        scale: scale,
        x: x,
        y: y,
        pointSize: currentPointSize
      },
      
      // Point data
      points: points.map(pt => {
        const info = plateInfo[pt.row - 1] || {};
        return {
          row: pt.row,
          x: pt.x,
          y: pt.y,
          size: pt.size || currentPointSize,
          plate: info.plate || `Plate ${pt.row}`,
          signals: info.signals || { "Signal": -Math.floor(Math.random()*40+50) }
        };
      })
    };

    // Download
    const blob = new Blob([JSON.stringify(finalData, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'floor_full_data.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    
    hasUnsavedChanges = false;
    setStatus('Exported successfully!', 'saved');
    
    alert("‚úÖ File Downloaded!\n\nThe JSON includes:\n‚Ä¢ " + points.length + " points\n‚Ä¢ Initial viewport settings\n‚Ä¢ Point sizes\n\nPlace 'floor_full_data.json' in your project folder.");
  };

  // Warn before leaving with unsaved changes
  window.onbeforeunload = () => {
    if (hasUnsavedChanges) {
      return "You have unsaved changes. Are you sure you want to leave?";
    }
  };

</script>
</body>
</html>
